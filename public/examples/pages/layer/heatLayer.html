<div id="viewer-container"></div>
<script>
    let map = undefined
    function getJSON(url, callback) {
        const xhr = new XMLHttpRequest();
        xhr.responseType = 'json';
        xhr.open('get', url, true);
        xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 300) {
                callback(xhr.response);
            } else {
                throw new Error(xhr.statusText);
            }
        };
        xhr.send();
    }
    function initViewer() {
        map = new CWC.Viewer('viewer-container')
        map.setOptions({
            globe: {
                depthTestAgainstTerrain: true // 深度检测
            },
            cameraController: {
                enableCollisionDetection: false // 地下模式
            },
            widgetController: {
                enableCompass2: true,
                enableStateBar: true,
                enableDistanceLegend: true,
                enableImagerySwitch: true,
                enableImagerySwitchTerrain: true
            }
        })
        getJSON("examples/data/drill.json", function (data) {
            const points = []
            data.features.forEach(function (feature) {
                var lng = feature.geometry.coordinates[0]
                var lat = feature.geometry.coordinates[1]
                var value = feature.properties.value
                points.push({ lng, lat, value })
            })
            const layer = new CWC.HeatLayer({
                radius: {
                    "1": 5,
                    "0.65": 9,
                    "0.4": 20,
                    "0.2": 50,
                    "0": 60
                }
            })
            map.addLayer(layer)
            layer.setPositions(points)

            map.flyToPosition([116.09, 38.54, 30000, 0, -30])
        })


    }
    CWC.ready(initViewer)
</script>
<style>
</style>